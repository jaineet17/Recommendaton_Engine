2025-03-20 14:29:16,013 - __main__ - INFO - ================================================================================
2025-03-20 14:29:16,013 - __main__ - INFO - STARTING API IN DEBUG MODE
2025-03-20 14:29:16,013 - __main__ - INFO - Python version: 3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 12:55:12) [Clang 14.0.6 ]
2025-03-20 14:29:16,013 - __main__ - INFO - Current directory: /Users/jaineet/Desktop/Recommendation_Engine
2025-03-20 14:29:16,013 - __main__ - INFO - ================================================================================
2025-03-20 14:29:16,013 - __main__ - INFO - Python path: ['/Users/jaineet/Desktop/Recommendation_Engine', '/opt/anaconda3/envs/movie-rec/lib/python312.zip', '/opt/anaconda3/envs/movie-rec/lib/python3.12', '/opt/anaconda3/envs/movie-rec/lib/python3.12/lib-dynload', '/opt/anaconda3/envs/movie-rec/lib/python3.12/site-packages', '/Users/jaineet/Desktop/Recommendation_Engine']
2025-03-20 14:29:16,013 - __main__ - INFO - Set KAFKA_BOOTSTRAP_SERVERS=localhost:29092
2025-03-20 14:29:16,013 - __main__ - INFO - Successfully imported feedback_loop module
2025-03-20 14:29:16,013 - __main__ - INFO - Attempting to import Kafka modules
2025-03-20 14:29:16,292 - __main__ - INFO - Successfully imported Kafka modules
2025-03-20 14:29:16,292 - __main__ - INFO - Importing Flask app
2025-03-20 14:29:16,609 - src.api.app - INFO - Imported feedback_loop module
2025-03-20 14:29:16,609 - src.api.app - INFO - Kafka integration enabled
2025-03-20 14:29:16,611 - src.kafka.producer - INFO - KAFKA DEBUG: Environment KAFKA_BOOTSTRAP_SERVERS=localhost:29092
2025-03-20 14:29:16,611 - src.kafka.producer - INFO - KAFKA DEBUG: Using bootstrap_servers=localhost:29092 from environment variable
2025-03-20 14:29:16,611 - src.kafka.producer - INFO - Connecting to Kafka brokers at localhost:29092
2025-03-20 14:29:16,611 - kafka.producer.kafka - DEBUG - Starting the Kafka producer
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name connections-closed
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name connections-created
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name select-time
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name io-time
2025-03-20 14:29:16,611 - kafka.client - DEBUG - Initiating connection to node bootstrap-0 at localhost:29092
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-sent-received
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-sent
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-received
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name request-latency
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.bytes-sent
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.bytes-received
2025-03-20 14:29:16,611 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.latency
2025-03-20 14:29:16,613 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <disconnected> [unspecified None]>: creating new socket
2025-03-20 14:29:16,613 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <disconnected> [IPv6 ('::1', 29092, 0, 0)]>: setting socket option (6, 1, 1)
2025-03-20 14:29:16,613 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: connecting to localhost:29092 [('::1', 29092, 0, 0) IPv6]
2025-03-20 14:29:16,613 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-20 14:29:16,614 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: established TCP connection
2025-03-20 14:29:16,614 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: Connection complete.
2025-03-20 14:29:16,614 - kafka.client - DEBUG - Node bootstrap-0 connected
2025-03-20 14:29:16,614 - kafka.protocol.parser - DEBUG - Sending request ApiVersionRequest_v0()
2025-03-20 14:29:16,614 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 1: ApiVersionRequest_v0()
2025-03-20 14:29:16,716 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v0(topics=[])
2025-03-20 14:29:16,717 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 2: MetadataRequest_v0(topics=[])
2025-03-20 14:29:16,717 - kafka.protocol.parser - DEBUG - Received correlation id: 1
2025-03-20 14:29:16,717 - kafka.protocol.parser - DEBUG - Processing response ApiVersionResponse_v0
2025-03-20 14:29:16,717 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 1 (103.21617126464844 ms): ApiVersionResponse_v0(error_code=0, api_versions=[(api_key=0, min_version=0, max_version=9), (api_key=1, min_version=0, max_version=13), (api_key=2, min_version=0, max_version=7), (api_key=3, min_version=0, max_version=12), (api_key=4, min_version=0, max_version=6), (api_key=5, min_version=0, max_version=3), (api_key=6, min_version=0, max_version=7), (api_key=7, min_version=0, max_version=3), (api_key=8, min_version=0, max_version=8), (api_key=9, min_version=0, max_version=8), (api_key=10, min_version=0, max_version=4), (api_key=11, min_version=0, max_version=9), (api_key=12, min_version=0, max_version=4), (api_key=13, min_version=0, max_version=5), (api_key=14, min_version=0, max_version=5), (api_key=15, min_version=0, max_version=5), (api_key=16, min_version=0, max_version=4), (api_key=17, min_version=0, max_version=1), (api_key=18, min_version=0, max_version=3), (api_key=19, min_version=0, max_version=7), (api_key=20, min_version=0, max_version=6), (api_key=21, min_version=0, max_version=2), (api_key=22, min_version=0, max_version=4), (api_key=23, min_version=0, max_version=4), (api_key=24, min_version=0, max_version=3), (api_key=25, min_version=0, max_version=3), (api_key=26, min_version=0, max_version=3), (api_key=27, min_version=0, max_version=1), (api_key=28, min_version=0, max_version=3), (api_key=29, min_version=0, max_version=3), (api_key=30, min_version=0, max_version=3), (api_key=31, min_version=0, max_version=3), (api_key=32, min_version=0, max_version=4), (api_key=33, min_version=0, max_version=2), (api_key=34, min_version=0, max_version=2), (api_key=35, min_version=0, max_version=4), (api_key=36, min_version=0, max_version=2), (api_key=37, min_version=0, max_version=3), (api_key=38, min_version=0, max_version=3), (api_key=39, min_version=0, max_version=2), (api_key=40, min_version=0, max_version=2), (api_key=41, min_version=0, max_version=3), (api_key=42, min_version=0, max_version=2), (api_key=43, min_version=0, max_version=2), (api_key=44, min_version=0, max_version=1), (api_key=45, min_version=0, max_version=0), (api_key=46, min_version=0, max_version=0), (api_key=47, min_version=0, max_version=0), (api_key=48, min_version=0, max_version=1), (api_key=49, min_version=0, max_version=1), (api_key=50, min_version=0, max_version=0), (api_key=51, min_version=0, max_version=0), (api_key=56, min_version=0, max_version=2), (api_key=57, min_version=0, max_version=1), (api_key=60, min_version=0, max_version=0), (api_key=61, min_version=0, max_version=0), (api_key=65, min_version=0, max_version=0), (api_key=66, min_version=0, max_version=0), (api_key=67, min_version=0, max_version=0)])
2025-03-20 14:29:16,721 - kafka.protocol.parser - DEBUG - Received correlation id: 2
2025-03-20 14:29:16,721 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v0
2025-03-20 14:29:16,722 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 2 (5.110025405883789 ms): MetadataResponse_v0(brokers=[(node_id=1, host='localhost', port=29092)], topics=[(error_code=0, topic='amazon-user-events', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:29:16,723 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-20 14:29:16,723 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name bufferpool-wait-time
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name batch-size
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name compression-rate
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name queue-time
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name produce-throttle-time
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name records-per-request
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name record-retries
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name errors
2025-03-20 14:29:16,723 - kafka.metrics.metrics - DEBUG - Added sensor with name record-size-max
2025-03-20 14:29:16,723 - kafka.producer.sender - DEBUG - Starting Kafka producer I/O thread.
2025-03-20 14:29:16,723 - kafka.producer.kafka - DEBUG - Kafka producer started
2025-03-20 14:29:16,724 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node bootstrap-0
2025-03-20 14:29:16,724 - src.kafka.producer - INFO - Connected to Kafka brokers for topic: product-events
2025-03-20 14:29:16,724 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:29:16,724 - src.kafka.producer - INFO - KAFKA DEBUG: Environment KAFKA_BOOTSTRAP_SERVERS=localhost:29092
2025-03-20 14:29:16,724 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 3: MetadataRequest_v1(topics=NULL)
2025-03-20 14:29:16,724 - src.kafka.producer - INFO - KAFKA DEBUG: Using bootstrap_servers=localhost:29092 from environment variable
2025-03-20 14:29:16,724 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 539887.000000, request 29999.984980
2025-03-20 14:29:16,724 - src.kafka.producer - INFO - Connecting to Kafka brokers at localhost:29092
2025-03-20 14:29:16,724 - kafka.producer.kafka - DEBUG - Starting the Kafka producer
2025-03-20 14:29:16,724 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 539886.000000, request 29999.687910
2025-03-20 14:29:16,724 - kafka.metrics.metrics - DEBUG - Added sensor with name connections-closed
2025-03-20 14:29:16,724 - kafka.metrics.metrics - DEBUG - Added sensor with name connections-created
2025-03-20 14:29:16,724 - kafka.metrics.metrics - DEBUG - Added sensor with name select-time
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name io-time
2025-03-20 14:29:16,725 - kafka.client - DEBUG - Initiating connection to node bootstrap-0 at localhost:29092
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-sent-received
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-sent
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes-received
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name request-latency
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.bytes-sent
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.bytes-received
2025-03-20 14:29:16,725 - kafka.metrics.metrics - DEBUG - Added sensor with name node-bootstrap-0.latency
2025-03-20 14:29:16,725 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <disconnected> [unspecified None]>: creating new socket
2025-03-20 14:29:16,725 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <disconnected> [IPv6 ('::1', 29092, 0, 0)]>: setting socket option (6, 1, 1)
2025-03-20 14:29:16,725 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: connecting to localhost:29092 [('::1', 29092, 0, 0) IPv6]
2025-03-20 14:29:16,725 - kafka.protocol.parser - DEBUG - Received correlation id: 3
2025-03-20 14:29:16,725 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:29:16,726 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 3 (1.898050308227539 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:29:16,726 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-03-20 14:29:16,727 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:29:16,727 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.854980, idle connection 539883.000000, request inf
2025-03-20 14:29:16,727 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: established TCP connection
2025-03-20 14:29:16,727 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: Connection complete.
2025-03-20 14:29:16,728 - kafka.client - DEBUG - Node bootstrap-0 connected
2025-03-20 14:29:16,728 - kafka.protocol.parser - DEBUG - Sending request ApiVersionRequest_v0()
2025-03-20 14:29:16,728 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 1: ApiVersionRequest_v0()
2025-03-20 14:29:16,833 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v0(topics=[])
2025-03-20 14:29:16,833 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 2: MetadataRequest_v0(topics=[])
2025-03-20 14:29:16,833 - kafka.protocol.parser - DEBUG - Received correlation id: 1
2025-03-20 14:29:16,833 - kafka.protocol.parser - DEBUG - Processing response ApiVersionResponse_v0
2025-03-20 14:29:16,833 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 1 (105.83925247192383 ms): ApiVersionResponse_v0(error_code=0, api_versions=[(api_key=0, min_version=0, max_version=9), (api_key=1, min_version=0, max_version=13), (api_key=2, min_version=0, max_version=7), (api_key=3, min_version=0, max_version=12), (api_key=4, min_version=0, max_version=6), (api_key=5, min_version=0, max_version=3), (api_key=6, min_version=0, max_version=7), (api_key=7, min_version=0, max_version=3), (api_key=8, min_version=0, max_version=8), (api_key=9, min_version=0, max_version=8), (api_key=10, min_version=0, max_version=4), (api_key=11, min_version=0, max_version=9), (api_key=12, min_version=0, max_version=4), (api_key=13, min_version=0, max_version=5), (api_key=14, min_version=0, max_version=5), (api_key=15, min_version=0, max_version=5), (api_key=16, min_version=0, max_version=4), (api_key=17, min_version=0, max_version=1), (api_key=18, min_version=0, max_version=3), (api_key=19, min_version=0, max_version=7), (api_key=20, min_version=0, max_version=6), (api_key=21, min_version=0, max_version=2), (api_key=22, min_version=0, max_version=4), (api_key=23, min_version=0, max_version=4), (api_key=24, min_version=0, max_version=3), (api_key=25, min_version=0, max_version=3), (api_key=26, min_version=0, max_version=3), (api_key=27, min_version=0, max_version=1), (api_key=28, min_version=0, max_version=3), (api_key=29, min_version=0, max_version=3), (api_key=30, min_version=0, max_version=3), (api_key=31, min_version=0, max_version=3), (api_key=32, min_version=0, max_version=4), (api_key=33, min_version=0, max_version=2), (api_key=34, min_version=0, max_version=2), (api_key=35, min_version=0, max_version=4), (api_key=36, min_version=0, max_version=2), (api_key=37, min_version=0, max_version=3), (api_key=38, min_version=0, max_version=3), (api_key=39, min_version=0, max_version=2), (api_key=40, min_version=0, max_version=2), (api_key=41, min_version=0, max_version=3), (api_key=42, min_version=0, max_version=2), (api_key=43, min_version=0, max_version=2), (api_key=44, min_version=0, max_version=1), (api_key=45, min_version=0, max_version=0), (api_key=46, min_version=0, max_version=0), (api_key=47, min_version=0, max_version=0), (api_key=48, min_version=0, max_version=1), (api_key=49, min_version=0, max_version=1), (api_key=50, min_version=0, max_version=0), (api_key=51, min_version=0, max_version=0), (api_key=56, min_version=0, max_version=2), (api_key=57, min_version=0, max_version=1), (api_key=60, min_version=0, max_version=0), (api_key=61, min_version=0, max_version=0), (api_key=65, min_version=0, max_version=0), (api_key=66, min_version=0, max_version=0), (api_key=67, min_version=0, max_version=0)])
2025-03-20 14:29:16,835 - kafka.protocol.parser - DEBUG - Received correlation id: 2
2025-03-20 14:29:16,835 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v0
2025-03-20 14:29:16,836 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 2 (2.6149749755859375 ms): MetadataResponse_v0(brokers=[(node_id=1, host='localhost', port=29092)], topics=[(error_code=0, topic='amazon-user-events', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:29:16,837 - kafka.conn - INFO - Broker version identified as 2.6.0
2025-03-20 14:29:16,837 - kafka.conn - INFO - Set configuration api_version=(2, 6, 0) to skip auto check_version requests on startup
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name bufferpool-wait-time
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name batch-size
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name compression-rate
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name queue-time
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name produce-throttle-time
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name records-per-request
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name bytes
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name record-retries
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name errors
2025-03-20 14:29:16,837 - kafka.metrics.metrics - DEBUG - Added sensor with name record-size-max
2025-03-20 14:29:16,837 - kafka.producer.sender - DEBUG - Starting Kafka producer I/O thread.
2025-03-20 14:29:16,837 - kafka.producer.kafka - DEBUG - Kafka producer started
2025-03-20 14:29:16,838 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node bootstrap-0
2025-03-20 14:29:16,838 - src.kafka.producer - INFO - Connected to Kafka brokers for topic: model-metrics
2025-03-20 14:29:16,838 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:29:16,838 - src.kafka.stream_processor - INFO - Initializing RealtimeRecommender
2025-03-20 14:29:16,838 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 3: MetadataRequest_v1(topics=NULL)
2025-03-20 14:29:16,838 - src.api.app - ERROR - Failed to initialize Kafka: 'ProductEventConsumer' object has no attribute 'consumer_type'
2025-03-20 14:29:16,838 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 539886.000000, request 29999.987841
2025-03-20 14:29:16,838 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 539886.000000, request 29999.772072
2025-03-20 14:29:16,838 - src.api.app - INFO - Loading models from /Users/jaineet/Desktop/Recommendation_Engine/data/models
2025-03-20 14:29:16,840 - kafka.protocol.parser - DEBUG - Received correlation id: 3
2025-03-20 14:29:16,840 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:29:16,841 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 3 (2.605915069580078 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:29:16,842 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:29:16,842 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.933105, idle connection 539882.000000, request inf
2025-03-20 14:29:16,844 - src.api.app - INFO - Loaded NCF model with 9372 users and 6594 items
2025-03-20 14:29:16,848 - src.api.app - INFO - Loaded LightGCN model with 9372 users and 6594 items
2025-03-20 14:29:16,852 - src.api.app - INFO - Loaded Simple MF model with 9372 users and 6594 items
2025-03-20 14:29:16,856 - src.api.app - INFO - Loaded Content-Based model with 9372 users and 6594 items
2025-03-20 14:29:16,856 - src.api.app - INFO - Creating hybrid model from LightGCN and Content-Based models
2025-03-20 14:29:16,867 - src.api.app - INFO - Initialized popular products list with 100 items
2025-03-20 14:29:16,867 - __main__ - INFO - Flask app imported successfully
2025-03-20 14:29:16,867 - __main__ - INFO - Starting Flask application on port 5050
2025-03-20 14:29:16,905 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5050
 * Running on http://192.168.1.157:5050
2025-03-20 14:29:16,905 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-20 14:29:35,334 - src.api.app - INFO - Request to /api/health completed in 0.0003s
2025-03-20 14:29:35,334 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:29:35] "GET /api/health HTTP/1.1" 200 -
2025-03-20 14:29:38,805 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:29:38,806 - src.api.app - INFO - Request to /api/metrics completed in 0.0009s
2025-03-20 14:29:38,806 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:29:38] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:30:08,826 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:30:08,828 - src.api.app - INFO - Request to /api/metrics completed in 0.0018s
2025-03-20 14:30:08,828 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:30:08] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:30:29,414 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:30:29,415 - src.api.app - INFO - Request to /api/metrics completed in 0.0005s
2025-03-20 14:30:29,415 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:30:29] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:30:38,845 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:30:38,847 - src.api.app - INFO - Request to /api/metrics completed in 0.0025s
2025-03-20 14:30:38,848 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:30:38] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:30:45,945 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:30:45,948 - src.api.app - INFO - Request to /api/recommend/lightgcn/A1L01D2BD3RKVO completed in 0.0030s
2025-03-20 14:30:45,948 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:30:45] "GET /api/recommend/lightgcn/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:31:00,021 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:31:00,025 - src.api.app - INFO - Request to /api/recommend/hybrid/A1L01D2BD3RKVO completed in 0.0037s
2025-03-20 14:31:00,025 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:31:00] "GET /api/recommend/hybrid/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:31:07,179 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:31:07,180 - src.api.app - INFO - Request to /api/recommend/ncf/A1L01D2BD3RKVO completed in 0.0011s
2025-03-20 14:31:07,180 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:31:07] "GET /api/recommend/ncf/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:31:08,864 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:31:08,865 - src.api.app - INFO - Request to /api/metrics completed in 0.0006s
2025-03-20 14:31:08,865 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:31:08] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:31:38,876 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:31:38,877 - src.api.app - INFO - Request to /api/metrics completed in 0.0008s
2025-03-20 14:31:38,877 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:31:38] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:32:08,888 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:32:08,888 - src.api.app - INFO - Request to /api/metrics completed in 0.0005s
2025-03-20 14:32:08,889 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:32:08] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:32:38,906 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:32:38,907 - src.api.app - INFO - Request to /api/metrics completed in 0.0012s
2025-03-20 14:32:38,908 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:32:38] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:33:08,945 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:33:08,946 - src.api.app - INFO - Request to /api/metrics completed in 0.0007s
2025-03-20 14:33:08,946 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:33:08] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:33:38,963 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:33:38,964 - src.api.app - INFO - Request to /api/metrics completed in 0.0013s
2025-03-20 14:33:38,965 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:33:38] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:34:08,984 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:34:08,985 - src.api.app - INFO - Request to /api/metrics completed in 0.0012s
2025-03-20 14:34:08,985 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:08] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:34:16,730 - kafka.client - DEBUG - Initializing connection to node 1 for metadata request
2025-03-20 14:34:16,732 - kafka.client - DEBUG - Initiating connection to node 1 at localhost:29092
2025-03-20 14:34:16,733 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.bytes-sent
2025-03-20 14:34:16,734 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.bytes-received
2025-03-20 14:34:16,734 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.latency
2025-03-20 14:34:16,735 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <disconnected> [unspecified None]>: creating new socket
2025-03-20 14:34:16,735 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <disconnected> [IPv6 ('::1', 29092, 0, 0)]>: setting socket option (6, 1, 1)
2025-03-20 14:34:16,735 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: connecting to localhost:29092 [('::1', 29092, 0, 0) IPv6]
2025-03-20 14:34:16,736 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata inf, idle connection 239875.000000, request inf
2025-03-20 14:34:16,736 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: established TCP connection
2025-03-20 14:34:16,736 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: Connection complete.
2025-03-20 14:34:16,737 - kafka.client - DEBUG - Node 1 connected
2025-03-20 14:34:16,737 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]>: Closing connection. 
2025-03-20 14:34:16,738 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:34:16,741 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:34:16,741 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 1: MetadataRequest_v1(topics=NULL)
2025-03-20 14:34:16,742 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239868.000000, request 29999.982834
2025-03-20 14:34:16,743 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239867.000000, request 29999.113083
2025-03-20 14:34:16,745 - kafka.protocol.parser - DEBUG - Received correlation id: 1
2025-03-20 14:34:16,745 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:34:16,747 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 1 (5.048036575317383 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:34:16,753 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:34:16,754 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.325195, idle connection 239857.000000, request inf
2025-03-20 14:34:16,844 - kafka.client - DEBUG - Initializing connection to node 1 for metadata request
2025-03-20 14:34:16,844 - kafka.client - DEBUG - Initiating connection to node 1 at localhost:29092
2025-03-20 14:34:16,844 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.bytes-sent
2025-03-20 14:34:16,845 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.bytes-received
2025-03-20 14:34:16,845 - kafka.metrics.metrics - DEBUG - Added sensor with name node-1.latency
2025-03-20 14:34:16,845 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <disconnected> [unspecified None]>: creating new socket
2025-03-20 14:34:16,845 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <disconnected> [IPv6 ('::1', 29092, 0, 0)]>: setting socket option (6, 1, 1)
2025-03-20 14:34:16,845 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: connecting to localhost:29092 [('::1', 29092, 0, 0) IPv6]
2025-03-20 14:34:16,845 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata inf, idle connection 239878.000000, request inf
2025-03-20 14:34:16,846 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: established TCP connection
2025-03-20 14:34:16,846 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connecting> [IPv6 ('::1', 29092, 0, 0)]>: Connection complete.
2025-03-20 14:34:16,846 - kafka.client - DEBUG - Node 1 connected
2025-03-20 14:34:16,846 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-2, node_id=bootstrap-0 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]>: Closing connection. 
2025-03-20 14:34:16,848 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:34:16,848 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:34:16,849 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 1: MetadataRequest_v1(topics=NULL)
2025-03-20 14:34:16,849 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239875.000000, request 29999.989033
2025-03-20 14:34:16,849 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239875.000000, request 29999.855995
2025-03-20 14:34:16,850 - kafka.protocol.parser - DEBUG - Received correlation id: 1
2025-03-20 14:34:16,851 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:34:16,852 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 1 (2.6350021362304688 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:34:16,853 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:34:16,853 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.822021, idle connection 239871.000000, request inf
2025-03-20 14:34:38,574 - src.api.app - INFO - Request to /health completed in 0.0008s
2025-03-20 14:34:38,575 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /health HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,577 - src.api.app - INFO - Request to /api/health completed in 0.0001s
2025-03-20 14:34:38,578 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "GET /api/health HTTP/1.1" 200 -
2025-03-20 14:34:38,579 - src.api.app - INFO - Request to / completed in 0.0001s
2025-03-20 14:34:38,580 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET / HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,581 - src.api.app - INFO - Request to /api completed in 0.0001s
2025-03-20 14:34:38,581 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /api HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,583 - src.api.app - INFO - Request to /health completed in 0.0001s
2025-03-20 14:34:38,583 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /health HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,584 - src.api.app - INFO - Request to /api/health completed in 0.0003s
2025-03-20 14:34:38,584 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "GET /api/health HTTP/1.1" 200 -
2025-03-20 14:34:38,585 - src.api.app - INFO - Request to / completed in 0.0001s
2025-03-20 14:34:38,585 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET / HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,586 - src.api.app - INFO - Request to /api completed in 0.0001s
2025-03-20 14:34:38,586 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /api HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,587 - src.api.app - INFO - Request to /health completed in 0.0001s
2025-03-20 14:34:38,587 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /health HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,588 - src.api.app - INFO - Request to /api/health completed in 0.0001s
2025-03-20 14:34:38,588 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "GET /api/health HTTP/1.1" 200 -
2025-03-20 14:34:38,589 - src.api.app - INFO - Request to / completed in 0.0001s
2025-03-20 14:34:38,590 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET / HTTP/1.1[0m" 404 -
2025-03-20 14:34:38,591 - src.api.app - INFO - Request to /api completed in 0.0001s
2025-03-20 14:34:38,591 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:38] "[33mGET /api HTTP/1.1[0m" 404 -
2025-03-20 14:34:39,001 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:34:39,001 - src.api.app - INFO - Request to /api/metrics completed in 0.0008s
2025-03-20 14:34:39,002 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:34:39] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:35:09,010 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:35:09,011 - src.api.app - INFO - Request to /api/metrics completed in 0.0006s
2025-03-20 14:35:09,011 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:35:09] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:35:12,744 - src.api.app - INFO - Request to /api/recommendations/A1L01D2BD3RKVO completed in 0.0001s
2025-03-20 14:35:12,744 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:35:12] "[33mGET /api/recommendations/A1L01D2BD3RKVO?model=hybrid HTTP/1.1[0m" 404 -
2025-03-20 14:35:39,028 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:35:39,030 - src.api.app - INFO - Request to /api/metrics completed in 0.0023s
2025-03-20 14:35:39,031 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:35:39] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:36:09,039 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:36:09,040 - src.api.app - INFO - Request to /api/metrics completed in 0.0009s
2025-03-20 14:36:09,040 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:36:09] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:36:26,559 - src.api.app - INFO - Request to /api/health completed in 0.0003s
2025-03-20 14:36:26,560 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:36:26] "GET /api/health HTTP/1.1" 200 -
2025-03-20 14:36:37,784 - src.api.app - INFO - Request to /api/recommendations/A1L01D2BD3RKVO completed in 0.0002s
2025-03-20 14:36:37,784 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:36:37] "[33mGET /api/recommendations/A1L01D2BD3RKVO?model=hybrid HTTP/1.1[0m" 404 -
2025-03-20 14:36:39,050 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:36:39,050 - src.api.app - INFO - Request to /api/metrics completed in 0.0004s
2025-03-20 14:36:39,050 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:36:39] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:36:47,678 - src.api.app - INFO - Request to /api/recommendations/A1L01D2BD3RKVO completed in 0.0001s
2025-03-20 14:36:47,678 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:36:47] "[33mGET /api/recommendations/A1L01D2BD3RKVO?model=hybrid HTTP/1.1[0m" 404 -
2025-03-20 14:37:09,060 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:37:09,061 - src.api.app - INFO - Request to /api/metrics completed in 0.0006s
2025-03-20 14:37:09,061 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:37:09] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:37:39,073 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:37:39,074 - src.api.app - INFO - Request to /api/metrics completed in 0.0009s
2025-03-20 14:37:39,074 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:37:39] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:37:41,142 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:37:41,145 - src.api.app - INFO - Request to /api/recommend/hybrid/A1L01D2BD3RKVO completed in 0.0023s
2025-03-20 14:37:41,145 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:37:41] "GET /api/recommend/hybrid/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:37:52,135 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:37:52,136 - src.api.app - INFO - Request to /api/recommend/lightgcn/A1L01D2BD3RKVO completed in 0.0009s
2025-03-20 14:37:52,136 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:37:52] "GET /api/recommend/lightgcn/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:38:09,087 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:38:09,087 - src.api.app - INFO - Request to /api/metrics completed in 0.0007s
2025-03-20 14:38:09,088 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:38:09] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:38:16,613 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 60139.532227, idle connection 300131.000000, request inf
2025-03-20 14:38:16,726 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 60126.503906, idle connection 300124.000000, request inf
2025-03-20 14:38:28,347 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:38:28,349 - src.api.app - INFO - Request to /api/recommend/content_based/A1L01D2BD3RKVO completed in 0.0016s
2025-03-20 14:38:28,349 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:38:28] "GET /api/recommend/content_based/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:38:39,102 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:38:39,103 - src.api.app - INFO - Request to /api/metrics completed in 0.0011s
2025-03-20 14:38:39,103 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:38:39] "GET /api/metrics HTTP/1.1" 200 -
2025-03-20 14:38:41,070 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:38:41,071 - src.api.app - INFO - Request to /api/recommend/ncf/A1L01D2BD3RKVO completed in 0.0012s
2025-03-20 14:38:41,072 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:38:41] "GET /api/recommend/ncf/A1L01D2BD3RKVO HTTP/1.1" 200 -
2025-03-20 14:38:51,311 - feedback_loop - WARNING - Missing required fields in event
2025-03-20 14:38:51,311 - src.api.app - INFO - Handling new user: NEW_USER_ID
2025-03-20 14:38:51,311 - feedback_loop - INFO - Handling new user: NEW_USER_ID
2025-03-20 14:38:51,311 - feedback_loop - INFO - Created new user NEW_USER_ID in events storage
2025-03-20 14:38:51,311 - src.api.app - INFO - Getting cold-start recommendations for model lightgcn, top_n=20
2025-03-20 14:38:51,311 - src.api.app - INFO - Getting cold-start recommendations for model content_based, top_n=20
2025-03-20 14:38:51,311 - src.api.app - INFO - Request to /api/recommend/hybrid/NEW_USER_ID completed in 0.0005s
2025-03-20 14:38:51,311 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:38:51] "GET /api/recommend/hybrid/NEW_USER_ID HTTP/1.1" 200 -
2025-03-20 14:39:09,111 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:39:09,125 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:39:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:39:16,755 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:39:16,755 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:39:16,755 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 2: MetadataRequest_v1(topics=NULL)
2025-03-20 14:39:16,755 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239989.000000, request 29999.984026
2025-03-20 14:39:16,756 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239989.000000, request 29999.830961
2025-03-20 14:39:16,759 - kafka.protocol.parser - DEBUG - Received correlation id: 2
2025-03-20 14:39:16,759 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:39:16,759 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 2 (3.551959991455078 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:39:16,760 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:39:16,760 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.936279, idle connection 239984.000000, request inf
2025-03-20 14:39:16,854 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:39:16,854 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:39:16,855 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 2: MetadataRequest_v1(topics=NULL)
2025-03-20 14:39:16,855 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239995.000000, request 29999.991894
2025-03-20 14:39:16,855 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239995.000000, request 29999.866009
2025-03-20 14:39:16,857 - kafka.protocol.parser - DEBUG - Received correlation id: 2
2025-03-20 14:39:16,857 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:39:16,858 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 2 (2.959012985229492 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:39:16,858 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:39:16,858 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.934814, idle connection 239991.000000, request inf
2025-03-20 14:39:39,143 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:39:39,148 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:39:39] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:40:09,152 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:40:09,154 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:40:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:40:39,187 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:40:39,192 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:40:39] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:41:09,212 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:41:09,218 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:41:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:41:39,225 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:41:39,228 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:41:39] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:42:09,245 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:42:09,251 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:42:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:42:39,262 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:42:39,266 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:42:39] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:43:09,276 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:43:09,281 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:43:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:43:16,747 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 60012.782959, idle connection 300011.000000, request inf
2025-03-20 14:43:16,852 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 60006.620850, idle connection 300005.000000, request inf
2025-03-20 14:43:39,291 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:43:39,294 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:43:39] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:44:09,310 - src.api.app - WARNING - Could not calculate average for metric status: could not convert string to float: 'fallback_model'
2025-03-20 14:44:09,316 - werkzeug - INFO - 127.0.0.1 - - [20/Mar/2025 14:44:09] "[35m[1mGET /api/metrics HTTP/1.1[0m" 500 -
2025-03-20 14:44:16,550 - src.kafka.stream_processor - INFO - Received signal 15, shutting down
2025-03-20 14:44:16,550 - src.kafka.stream_processor - INFO - Stopping RealtimeRecommender
2025-03-20 14:44:16,550 - src.kafka.stream_processor - INFO - RealtimeRecommender stopped. Stats: 0 messages processed, 0 errors in 0.0 seconds
2025-03-20 14:44:16,763 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:44:16,763 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:44:16,764 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 3: MetadataRequest_v1(topics=NULL)
2025-03-20 14:44:16,764 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239994.000000, request 29999.979973
2025-03-20 14:44:16,764 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239994.000000, request 29999.746084
2025-03-20 14:44:16,769 - kafka.protocol.parser - DEBUG - Received correlation id: 3
2025-03-20 14:44:16,769 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:44:16,770 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 3 (5.793094635009766 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:44:16,771 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:44:16,771 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.833008, idle connection 239987.000000, request inf
2025-03-20 14:44:16,860 - kafka.client - DEBUG - Sending metadata request MetadataRequest_v1(topics=NULL) to node 1
2025-03-20 14:44:16,860 - kafka.protocol.parser - DEBUG - Sending request MetadataRequest_v1(topics=NULL)
2025-03-20 14:44:16,861 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Request 3: MetadataRequest_v1(topics=NULL)
2025-03-20 14:44:16,861 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239996.000000, request 29999.983072
2025-03-20 14:44:16,861 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 30000.000000, idle connection 239996.000000, request 29999.685287
2025-03-20 14:44:16,864 - kafka.protocol.parser - DEBUG - Received correlation id: 3
2025-03-20 14:44:16,864 - kafka.protocol.parser - DEBUG - Processing response MetadataResponse_v1
2025-03-20 14:44:16,864 - kafka.conn - DEBUG - <BrokerConnection client_id=kafka-python-producer-2, node_id=1 host=localhost:29092 <connected> [IPv6 ('::1', 29092, 0, 0)]> Response 3 (3.773927688598633 ms): MetadataResponse_v1(brokers=[(node_id=1, host='localhost', port=29092, rack=None)], controller_id=1, topics=[(error_code=0, topic='amazon-user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-requests', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-updates', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-recommendation-responses', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='__consumer_offsets', is_internal=True, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=10, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=20, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=40, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=30, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=9, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=11, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=31, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=39, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=13, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=18, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=22, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=8, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=32, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=43, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=29, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=34, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=6, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=41, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=27, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=48, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=5, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=15, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=35, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=25, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=46, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=26, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=36, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=44, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=16, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=37, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=17, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=45, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=3, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=24, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=38, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=33, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=23, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=28, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=12, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=19, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=14, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=4, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=47, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=49, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=42, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=7, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=21, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-model-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-product-views', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-system-metrics', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-data-drift', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='user-events', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-purchases', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='_schemas', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1])]), (error_code=0, topic='amazon-reviews', is_internal=False, partitions=[(error_code=0, partition=0, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=2, leader=1, replicas=[1], isr=[1]), (error_code=0, partition=1, leader=1, replicas=[1], isr=[1])])])
2025-03-20 14:44:16,867 - kafka.cluster - DEBUG - Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 13, groups: 0)
2025-03-20 14:44:16,867 - kafka.client - DEBUG - Timeouts: user 9999999990.000000, metadata 299999.871094, idle connection 239990.000000, request inf
